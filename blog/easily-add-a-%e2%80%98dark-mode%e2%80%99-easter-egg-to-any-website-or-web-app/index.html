<!DOCTYPE html>
<html lang="en">

<head>
    <script type="text/javascript" src="/scripts/insertheader.js"></script>
    <noscript>
        <h1>I&apos;m a minimalist at heart, but I do have to run some lightweight Javascript to keep this website manageable! Please enable it for a better experience :)</h1>
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="/css/prism.css">
    </noscript>
</head>

<body>

    <section class="section post" style="padding-top: 30vh;">
        <h1 class="title">Easily add a &#x2018;dark mode&#x2019; easter egg to any website or web app</h1>
        <div class="content">
            <span class="meta">
                <h4 class="date">2019/19/09</h4>
                <h2 class="tags"><a href="/blog/tags/ui">ui</a>, <a href="/blog/tags/css">css</a>, <a href="/blog/tags/javascript">javascript</a></h2>
            </span>
            <div class="main">
                <div class="body">
<p>Fact of the day: James Bond is based on real WWII spy, Dusan Popov. Today, let&#x2019;s spice up our web project with a dark mode easter egg, unlocked with a secret code.</p>
<p><a href="https://codepen.io/bradeneast/pen/vYBrvbK">Here&#x2019;s the demo on CodePen.</a></p>
<h4>Summary</h4>
<p>Toggle a CSS class of &#x2018;dark-mode&#x2019; on the <code>body</code> element when a series of <code>keydown</code> events happens in the right order.</p>
<div id="darkModeDemo">
<style>
    @keyframes fadeInOut {
        0% {
            opacity: 0;
        }
        50% {
            opacity: 1;
        }
        100% {
            opacity: 0;
        }
    }
    #darkModeDemo {
        position: relative;
        width: 100%;
        height: 30rem;
    }
    .darkModeDemo {
        position: absolute;
        width: 100%;
        height: 100%;
        display: grid;
        place-items: center;
    }
    #dark {
        background: #111;
        color: white;
    }
    #light {
        background: #eee;
        color: black;
        animation: fadeInOut 8s infinite reverse;
    }
</style>
<div class="darkModeDemo" id="dark">Dark Mode</div>
<div class="darkModeDemo" id="light">Light Mode</div>
</div>
<h4>Code</h4>
<p>To set up this feature in our project, we&#x2019;ll need a few lines of CSS that will change the background of our site and apply an <code>invert()</code> filter to everything.</p>
<pre><code class="language-css"><span class="token selector">body.dm</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> currentColor<span class="token punctuation">;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We could just throw this on and call it good. But we&#x2019;re not going to settle for mediocre tricks, are we? Let&#x2019;s make this a &#x2018;smart&#x2019; dark mode, to imitate a popular iOS feature. For the dark mode to be smart, it needs to ignore images, only inverting things like typography and background colors.</p>
<pre><code class="language-css"><span class="token selector">body.dm</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> currentColor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">body.dm h1,
body.dm h2,
body.dm h3,
body.dm h4,
body.dm h5,
body.dm p,
body.dm ul,
body.dm ol,
body.dm p img,
body.dm ul img,
body.dm ol img</span> <span class="token punctuation">{</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token selector">body.dm ul h1,
body.dm ul h2,
body.dm ul h3,
body.dm ul h4,
body.dm ul h5,
body.dm ul p,
body.dm ol h1,
body.dm ol h2,
body.dm ol h3,
body.dm ol h4,
body.dm ol h5,
body.dm ol p</span> <span class="token punctuation">{</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> none
<span class="token punctuation">}</span>
</code></pre>
<h4>Bonus</h4>
<p>By injecting this CSS as a string, we can bundle up a JS snippet that enables the hidden dark mode feature on any website or web app. Plus, we can use a custom activation code by passing in our own array of keys to be pressed.</p>
<pre><code class="language-javascript"><span class="token keyword">const</span> konami <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;ArrowUp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowUp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowDown&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowDown&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowLeft&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowRight&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowLeft&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ArrowRight&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> darkModeSuccess <span class="token operator">=</span> <span class="token string">&apos;Dark Mode unlocked. Repeat code to turn off.&apos;</span><span class="token punctuation">;</span>
<span class="token function">initDarkMode</span><span class="token punctuation">(</span>konami<span class="token punctuation">,</span> darkModeSuccess<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">initDarkMode</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> successMessage</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> darkModeStyles <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&apos;style&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    darkModeStyles<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&apos;body.dm{background:currentColor}body.dm h1,body.dm h2,body.dm h3,body.dm h4,body.dm h5,body.dm p,body.dm ul,body.dm ol,body.dm p img,body.dm ul img,body.dm ol img{filter:invert(1)}body.dm ul h1,body.dm ul h2,body.dm ul h3,body.dm ul h4,body.dm ul h5,body.dm ul p,body.dm ol h1,body.dm ol h2,body.dm ol h3,body.dm ol h4,body.dm ol h5,body.dm ol p{filter:none}&apos;</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>darkModeStyles<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> darkModeOn <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&apos;darkModeOn&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>darkModeOn<span class="token punctuation">)</span> <span class="token punctuation">{</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token string">&apos;dm&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&apos;keydown&apos;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> e<span class="token punctuation">.</span>key <span class="token operator">!==</span> code<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        current<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code<span class="token punctuation">.</span>length <span class="token operator">===</span> current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>darkModeOn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                darkModeOn <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                darkModeOn <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                window<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span>successMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&apos;darkModeOn&apos;</span><span class="token punctuation">,</span> darkModeOn<span class="token punctuation">)</span><span class="token punctuation">;</span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token string">&apos;dm&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>P.S. Thanks to <a href="https://gomakethings.com">Chris Ferdinandi</a> for the konami idea and concise key handler logic!</p>
<span class="post-cta"><p>Thanks for reading! If you learned something useful, <a target="_blank" href="https://twitter.com/share?text=Easily%20add%20a%20%e2%80%98dark%20mode%e2%80%99%20easter%20egg%20to%20any%20website%20or%20web%20app%20by%20@bradenthehair%20-%20&amp;url=https://bradeneast.com/blog/easily-add-a-%e2%80%98dark-mode%e2%80%99-easter-egg-to-any-website-or-web-app">share this article</a> with your followers. I appreciate it!</p></span></div>
            </div>
        </div>
    </section>

    <section class="section post-nav">
        <a href id="previous-post" style="display: none">
            <div class="link-title">
                <div class="label">previous</div>
                <svg viewbox="0 0 9 18">
                    <polyline stroke="currentColor" stroke-width="1.7" fill="none" points="8,1 0,9 8,17">
                </polyline></svg>
            </div>
        </a>
        <a href="/blog/making-ui-knobs-and-dials-with-html-and-css" id="next-post">
            <div class="link-title">
                <div class="label">next</div>
                <svg viewbox="0 0 9 18">
                    <polyline stroke="currentColor" stroke-width="1.7" fill="none" points="1,1 9,9 1,17">
                </polyline></svg>
            Making UI knobs and dials with HTML and CSS</div>
        </a>
    </section>
    <script type="text/javascript" src="/scripts/insertfooter.js"></script>

</body>

</html>