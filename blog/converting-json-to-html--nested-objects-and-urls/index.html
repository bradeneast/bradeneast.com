<!DOCTYPE html>
<html lang="en">

<head>
    <noscript>
        <h1>I&apos;m a minimalist at heart, but I do have to run some lightweight Javascript to keep this website manageable! Please enable it for a better experience :)</h1>
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="/css/prism.css">
    </noscript>
    <script type="text/javascript" src="/scripts/insertheader.js"></script>

    <!-- Start SEO Framework -->
    <title>Blog of Braden East &#xA0;|&#xA0; Converting JSON to HTML - Nested objects and URLs</title>
    <meta name="description" content="The blog for design-oriented devs. Get regular tips to improve your UI and UX design skills.">
    <meta property="og:image" content="/images/blog/this-is-fine.gif">
    <meta property="og:image:width" content="1080">
    <meta property="og:image:height" content="1080">
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Blog of Braden East &#xA0;|&#xA0; Converting JSON to HTML - Nested objects and URLs">
    <meta property="og:description" content="The blog for design-oriented devs. Get regular tips to improve your UI and UX design skills.">
    <meta property="og:url" content="https://bradeneast.com/blog/converting-json-to-html--nested-objects-and-urls">
    <meta property="og:site_name" content="Braden East">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@bradenthehair">
    <meta name="twitter:title" content="Blog of Braden East &#xA0;|&#xA0; Converting JSON to HTML - Nested objects and URLs">
    <meta name="twitter:description" content="The blog for design-oriented devs. Get regular tips to improve your UI and UX design skills.">
    <meta name="twitter:image" content="/images/blog/this-is-fine.gif">
    <link rel="canonical" href="https://bradeneast.com/blog/converting-json-to-html--nested-objects-and-urls">
    <!-- End SEO Framework --></head>

<body>

    <section class="section post" style="padding-top: 30vh;">
        <h1 class="title">Converting JSON to HTML - Nested objects and URLs</h1>
        <div class="content">
            <span class="meta">
                <h4 class="date">2019/08/07</h4>
                <h2 class="tags"><a href="/blog/tags/javascript">javascript</a>, <a href="/blog/tags/html">html</a></h2>
            </span>
            <div class="main">
                <div class="body">
<p>No developer wants to debug code written for a single use case. Sometimes you have to bite the bullet and write an ultra-specific function, but the goal is to be kind to your future developer self.  Code you can reuse is code you don&#x2019;t have to write (or rewrite).</p>
<p>Recently, I posted about how to easily get values from a JSON object and place them dynamically in your HTML using <code>Object.keys()</code>. Let&#x2019;s expand my first approach to handle more complex JSON, inclduing URLS and nested objects, because sometimes we have to get that one value nested inside 5 other objects.</p>
<p>If you feel a bit lost, take a glance at the <a href="/blog/append-json-values-to-matching-html-elements-with-object.keys">simpler approach</a> and then come back and join me.</p>
<p>Let&#x2019;s make the safe assumption that an API isn&#x2019;t give us a responses in the exact format we&#x2019;d like. What if we want to populate an HTML template with data that contains urls, arrays, and nested objects?  Or, what if the API changes their response structure?</p>
<p><img src="/images/blog/this-is-fine.gif" alt="This is fine gif"></p>
<p>You might as well burn everything to the ground and start over.  Fortunately, there&#x2019;s a way to loop through multiple layers of JSON without too much excess javascript. Take this example:</p>
<pre><code class="language-javascript"><span class="token comment">// Array of movies</span>
<span class="token punctuation">[</span><span class="token punctuation">{</span>
        <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Star Wars Episode I&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;subtitle&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;The Phantom Menace&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;meta&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;link&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;https://www.imdb.com/title/tt0120915/&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;thumbnail&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;https://m.media-amazon.com/images/M/MV5BMTM1NTQzNDU3OV5BMl5BanBnXkFtZTcwODcyMzA4NA@@._V1_SY1000_CR0,0,1513,1000_AL_.jpg&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;tags&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;tatooine&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;podracing&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;gungans&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;naboo&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">///...more movies</span>
<span class="token punctuation">]</span>
</code></pre>
<p>The simple way I talked about before doesn&#x2019;t account for two things that are pretty common in JSON, shown above:</p>
<ol>
<li>Nested objects</li>
<li>URLs (for images or links) that need to be added to an attribute of the matching element, not inserted as text</li>
</ol>
<h4>Handling urls</h4>
<p>We know that a URL has to be a string, so let&#x2019;s start with an <code>if</code> statement that will check if the value is a string.  Then, we&#x2019;ll check if the string begins with &#x2018;http&#x2019;. If so, we&#x2019;ll make sure it&#x2019;s not an image, then add set the <code>href</code> value on the matching HTML element.</p>
<p>If the URL does reference an image, we&#x2019;ll set it as the background on the matching element. Sometimes, you might want this to be the <code>src</code> value on an <code>img</code> tag, but the same principle applies.</p>
<pre><code class="language-javascript"><span class="token keyword">let</span> element <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// check if value is a string</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;string&apos;</span> <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// check if string is a url</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&apos;http&apos;</span> <span class="token operator">||</span> key <span class="token operator">==</span> <span class="token string">&apos;link&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// check if url is an image with .match() and some basic regex</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\.*(jpg|png|svg|gif|webp)/g</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            element<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&apos;href&apos;</span><span class="token punctuation">,</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            element<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&apos;style&apos;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">background-image: url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">);</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// if not a link, do the standard thing</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">&apos;beforeend&apos;</span><span class="token punctuation">,</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4>Handling nested objects &amp; arrays</h4>
<p>Now, let&#x2019;s deal with the problem of how to loop through X layers of nested JSON and append the appropriate values to our HTML.  It&#x2019;s easier than you might think.</p>
<p>We need to be able to check if the value is an array.  With an array of strings, we can just use <code>array.join()</code> to combine the array into a single string.  In other situations, we&#x2019;d add a check to see if the array contained more objects to loop through.</p>
<pre><code class="language-javascript"><span class="token comment">// first, we&apos;ll make the whole thing a function</span>
<span class="token keyword">function</span> <span class="token function">loopThroughKeys</span><span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> element <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// check if value is a string</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;string&quot;</span> <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// stuff happens...</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// if value is an array, join it with a comma and a space (objects nested inside arrays would be handled a little differently)</span>
      object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">&quot;beforeend&quot;</span><span class="token punctuation">,</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// if value is an object, perform this function again on that object</span>
      <span class="token function">loopThroughKeys</span><span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>So, we solved the URL problem with a couple of <code>if</code> statements, and then collected our code in a function that can be invoked as many times as there are layers of JSON data.</p>
<p><a href="https://codepen.io/bradeneast/pen/KOQMBN/">Try out the demo on CodePen.</a></p>
<p>Just here for the snippet?  Here it is without all the comments.</p>
<pre><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">loopThroughKeys</span><span class="token punctuation">(</span><span class="token parameter">object<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> element <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;string&quot;</span> <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;http&quot;</span> <span class="token operator">||</span> key <span class="token operator">==</span> <span class="token string">&quot;link&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\.*(jpg|png|svg|gif|webp)/g</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          element<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;href&quot;</span><span class="token punctuation">,</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          element<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;style&quot;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">background-image: url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">);</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">&quot;beforeend&quot;</span><span class="token punctuation">,</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">&quot;beforeend&quot;</span><span class="token punctuation">,</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> object<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">loopThroughKeys</span><span class="token punctuation">(</span>object<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<span class="post-cta"><p>Thanks for reading! If you learned something useful, <a target="_blank" href="https://twitter.com/share?text=Converting%20json%20to%20html: nested%20objects%20and%20urls%20by%20@bradenthehair%20-%20&amp;url=https://bradeneast.com/blog/converting-json-to-html--nested-objects-and-urls">share this article</a> with your followers. I appreciate it!</p></span></div>
            </div>
        </div>
    </section>

    <section class="section post-nav">
        <a href="/blog/a-quick-way-to-improve-seo-and-accessibility--get-alt-attributes-from-image-src-with-vanilla-javascript" id="previous-post">
            <div class="link-title">
                <div class="label">previous</div>
                <svg viewbox="0 0 9 18">
                    <polyline stroke="currentColor" stroke-width="1.7" fill="none" points="8,1 0,9 8,17">
                </polyline></svg>
            A quick way to improve SEO and accessibility - get alt attributes from image src with vanilla javascript</div>
        </a>
        <a href="/blog/append-json-values-to-matching-html-elements-with-object.keys" id="next-post">
            <div class="link-title">
                <div class="label">next</div>
                <svg viewbox="0 0 9 18">
                    <polyline stroke="currentColor" stroke-width="1.7" fill="none" points="1,1 9,9 1,17">
                </polyline></svg>
            Append JSON values to matching HTML elements with Object.keys()</div>
        </a>
    </section>
    <script type="text/javascript" src="/scripts/insertfooter.js"></script>

</body>

</html>